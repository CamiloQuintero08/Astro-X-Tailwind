<div id="controls-carousel" class="relative w-full max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 mb-12 sm:mb-16 lg:mb-20 scroll-reveal" data-carousel="static">
  <div class="relative h-48 sm:h-64 md:h-80 lg:h-125 overflow-hidden shadow-2xl rounded-2xl bg-white/10">
    <div class="absolute inset-0 flex items-center justify-center p-4 sm:p-6 lg:p-8">
      <img
        src="/images/AstroTailwind.png"
        class="carousel-image max-w-full max-h-full object-contain drop-shadow-2xl active"
        data-carousel-item="active"
        data-index="0"
        alt="AstroTailwind"
      />
      <img
        src="/images/InfoImg.png"
        class="carousel-image max-w-full max-h-full object-contain drop-shadow-2xl"
        data-carousel-item
        data-index="1"
        alt="InfoImg"
      />
      <img
        src="/images/AstroTailwind.png"
        class="carousel-image max-w-full max-h-full object-contain drop-shadow-2xl"
        data-carousel-item
        data-index="2"
        alt="AstroTailwind"
      />
      <img
        src="/images/InfoImg.png"
        class="carousel-image max-w-full max-h-full object-contain drop-shadow-2xl"
        data-carousel-item
        data-index="3"
        alt="InfoImg"
      />
      <img
        src="/images/AstroTailwind.png"
        class="carousel-image max-w-full max-h-full object-contain drop-shadow-2xl"
        data-carousel-item
        data-index="4"
        alt="AstroTailwind"
      />
    </div>
  </div>

  <button
    type="button"
    class="absolute top-1/2 -translate-y-1/2 start-2 sm:start-4 z-30 flex items-center justify-center cursor-pointer group focus:outline-none transition-all hover:scale-110"
    data-carousel-prev
  >
    <span class="inline-flex items-center justify-center w-8 sm:w-10 lg:w-12 h-8 sm:h-10 lg:h-12 rounded-full bg-cyan-500/30 backdrop-blur-sm group-hover:bg-purple-700/40 transition-all shadow-lg border border-white/30">
      <svg class="w-4 sm:w-5 lg:w-6 h-4 sm:h-5 lg:h-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 19-7-7 7-7"/>
      </svg>
    </span>
  </button>
  <button
    type="button"
    class="absolute top-1/2 -translate-y-1/2 end-2 sm:end-4 z-30 flex items-center justify-center cursor-pointer group focus:outline-none transition-all hover:scale-110"
    data-carousel-next
  >
    <span class="inline-flex items-center justify-center w-8 sm:w-10 lg:w-12 h-8 sm:h-10 lg:h-12 rounded-full bg-cyan-500/30 backdrop-blur-sm group-hover:bg-purple-700/40 transition-all shadow-lg border border-white/30">
      <svg class="w-4 sm:w-5 lg:w-6 h-4 sm:h-5 lg:h-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"/>
      </svg>
    </span>
  </button>
  <div class="absolute bottom-3 sm:bottom-5 left-1/2 -translate-x-1/2 z-30 flex gap-2 sm:gap-3">
    <button type="button" class="w-2 h-2 sm:w-3 sm:h-3 rounded-full bg-white/50 hover:bg-white transition-all" data-carousel-slide-to="0"></button>
    <button type="button" class="w-2 h-2 sm:w-3 sm:h-3 rounded-full bg-white/50 hover:bg-white transition-all" data-carousel-slide-to="1"></button>
    <button type="button" class="w-2 h-2 sm:w-3 sm:h-3 rounded-full bg-white/50 hover:bg-white transition-all" data-carousel-slide-to="2"></button>
    <button type="button" class="w-2 h-2 sm:w-3 sm:h-3 rounded-full bg-white/50 hover:bg-white transition-all" data-carousel-slide-to="3"></button>
    <button type="button" class="w-2 h-2 sm:w-3 sm:h-3 rounded-full bg-white/50 hover:bg-white transition-all" data-carousel-slide-to="4"></button>
  </div>
</div>

<style>
  .scroll-reveal {
    opacity: 0;
    transform: translateY(50px);
    transition: opacity 0.8s ease-out, transform 0.8s ease-out;
  }

  .scroll-reveal.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .carousel-image {
    position: absolute;
    opacity: 0;
    transition: opacity 0.7s ease-in-out, transform 0.7s ease-in-out;
    pointer-events: none;
  }

  .carousel-image.active {
    opacity: 1;
    pointer-events: auto;
  }

  .carousel-image.slide-in-right {
    animation: slideInRight 0.7s ease-out forwards;
  }

  @keyframes slideInRight {
    0% {
      opacity: 0;
      transform: translateX(60px) scale(0.9);
    }
    100% {
      opacity: 1;
      transform: translateX(0) scale(1);
    }
  }

  .carousel-image.slide-in-left {
    animation: slideInLeft 0.7s ease-out forwards;
  }

  @keyframes slideInLeft {
    0% {
      opacity: 0;
      transform: translateX(-60px) scale(0.9);
    }
    100% {
      opacity: 1;
      transform: translateX(0) scale(1);
    }
  }

  .carousel-image.fade-out {
    animation: fadeOut 0.5s ease-in forwards;
  }

  @keyframes fadeOut {
    0% {
      opacity: 1;
      transform: scale(1);
    }
    100% {
      opacity: 0;
      transform: scale(0.92);
    }
  }
</style>

<script>
  const carousel = document.getElementById("controls-carousel");
  const images = carousel.querySelectorAll(".carousel-image");
  const nextBtn = carousel.querySelector("[data-carousel-next]");
  const prevBtn = carousel.querySelector("[data-carousel-prev]");
  const indicators = carousel.querySelectorAll("[data-carousel-slide-to]");

  let currentIndex = 0;
  let isTransitioning = false;

  function updateIndicators(index) {
    indicators.forEach((indicator, i) => {
      if (i === index) {
        indicator.classList.remove("bg-white/50");
        indicator.classList.add("bg-white");
      } else {
        indicator.classList.remove("bg-white");
        indicator.classList.add("bg-white/50");
      }
    });
  }

  function showSlide(newIndex, direction = 'next') {
    if (isTransitioning || newIndex === currentIndex) return;
    
    isTransitioning = true;
    const currentImage = images[currentIndex];
    const nextImage = images[newIndex];

    images.forEach(img => {
      img.classList.remove('slide-in-right', 'slide-in-left', 'fade-out');
    });

    currentImage.classList.add('fade-out');

    setTimeout(() => {
      currentImage.classList.remove('active');
      
      nextImage.classList.add('active');
      
      if (direction === 'next') {
        nextImage.classList.add('slide-in-right');
      } else {
        nextImage.classList.add('slide-in-left');
      }
    }, 100);

    currentImage.setAttribute("data-carousel-item", "");
    nextImage.setAttribute("data-carousel-item", "active");

    currentIndex = newIndex;
    updateIndicators(currentIndex);

    setTimeout(() => {
      isTransitioning = false;
      images.forEach(img => {
        img.classList.remove('slide-in-right', 'slide-in-left', 'fade-out');
      });
    }, 700);
  }

  nextBtn.addEventListener("click", () => {
    const nextIndex = (currentIndex + 1) % images.length;
    showSlide(nextIndex, 'next');
  });

  prevBtn.addEventListener("click", () => {
    const prevIndex = (currentIndex - 1 + images.length) % images.length;
    showSlide(prevIndex, 'prev');
  });

  indicators.forEach((indicator, index) => {
    indicator.addEventListener("click", () => {
      const direction = index > currentIndex ? 'next' : 'prev';
      showSlide(index, direction);
    });
  });

  let autoplayInterval = setInterval(() => {
    const nextIndex = (currentIndex + 1) % images.length;
    showSlide(nextIndex, 'next');
  }, 5000);

  carousel.addEventListener("mouseenter", () => {
    clearInterval(autoplayInterval);
  });

  carousel.addEventListener("mouseleave", () => {
    autoplayInterval = setInterval(() => {
      const nextIndex = (currentIndex + 1) % images.length;
      showSlide(nextIndex, 'next');
    }, 5000);
  });

  const observerOptions = {
    threshold: 0.2,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
      }
    });
  }, observerOptions);

  observer.observe(carousel);

  updateIndicators(currentIndex);
</script>